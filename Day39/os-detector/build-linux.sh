#!/bin/bash

# –°–∫—Ä–∏–ø—Ç —Å–±–æ—Ä–∫–∏ OS Detector –¥–ª—è Linux
# –†–∞–∑–º–µ—Å—Ç–∏—Ç–µ —ç—Ç–æ—Ç —Ñ–∞–π–ª –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞ –∏ —Å–¥–µ–ª–∞–π—Ç–µ –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–º: chmod +x build-linux.sh

set -e  # –ü—Ä–µ—Ä—ã–≤–∞—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö

echo "üêß –°–±–æ—Ä–∫–∞ OS Detector –¥–ª—è Linux..."
echo "üìÇ –¢–µ–∫—É—â–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è: $(pwd)"
echo "üîÑ –í–µ—Ä—Å–∏—è Go: $(go version)"

# –°–æ–∑–¥–∞–µ–º –ø–∞–ø–∫—É –¥–ª—è –±–∏–Ω–∞—Ä–Ω–∏–∫–æ–≤, –µ—Å–ª–∏ –µ—ë –Ω–µ—Ç
mkdir -p bin

# –û—á–∏—Å—Ç–∫–∞ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö —Å–±–æ—Ä–æ–∫
echo "üßπ –û—á–∏—Å—Ç–∫–∞ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö —Å–±–æ—Ä–æ–∫..."
rm -f os-detector os-detector-* bin/os-detector-*

# –°–±–æ—Ä–∫–∞ –¥–ª—è —Ç–µ–∫—É—â–µ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã
echo "üî® –°–±–æ—Ä–∫–∞ –¥–ª—è $(uname -m)..."
go build -o bin/os-detector

# –°–±–æ—Ä–∫–∞ –¥–ª—è –¥—Ä—É–≥–∏—Ö –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä Linux
echo "üî® –°–±–æ—Ä–∫–∞ –¥–ª—è AMD64..."
GOOS=linux GOARCH=amd64 go build -o bin/os-detector-amd64

echo "üî® –°–±–æ—Ä–∫–∞ –¥–ª—è ARM64..."
GOOS=linux GOARCH=arm64 go build -o bin/os-detector-arm64

echo "üî® –°–±–æ—Ä–∫–∞ –¥–ª—è 386..."
GOOS=linux GOARCH=386 go build -o bin/os-detector-386

# –î–µ–ª–∞–µ–º —Ñ–∞–π–ª—ã –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–º–∏
chmod +x bin/os-detector*

echo "‚úÖ –°–±–æ—Ä–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞!"
echo "üì¶ –°–æ–±—Ä–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:"
ls -la bin/os-detector*

echo ""
echo "üöÄ –î–ª—è –∑–∞–ø—É—Å–∫–∞ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:"
echo "   ./bin/os-detector"